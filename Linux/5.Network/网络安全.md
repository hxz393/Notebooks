# 网络安全

## 网络传输流程

当一个安全配置的服务器要接收外来数据时,可以分为以下阶段:

- 防火墙的分析

  Linux系统内建防火墙机制,因此首先连接要通过防火墙.默认防火墙有两个机制:

  - 数据包过滤防火墙(IP Filtering或Net Filter)

    简单地说就是iptables或firewall提供地防火墙功能,它主要分析OSI地第二,三,四层,主要控制的就是MAC,IP,ICMP,TCP和UDP的端口与状态(SYN,ACK等).

  - 访问控制列表(TCP Wrappers)

    系统会检查/etc/hosts.allow与/etc/hosts.deny的配置,来过滤某些IP与端口.

- 服务的基本功能

  在应用层面来看,某些软件带有控制访问功能.例如httpd.conf配置文件内可以规定某些IP来源不能使用httpd这个服务来取得主机的数据.

- SELinux对网络服务的权限控制

  为了避免前一个步骤的权限误用,或者是程序有问题所造成的安全问题,SELinux可以针对网络服务的权限设置一些规则,让程序能够拥有的功能有限.这样即使httpd真的被攻击取得root的使用权,所能操作的范围也被控制在/var/www/html里面,无法对系统造成进一步威胁.

- 使用主机的文件系统资源

  主要是文件系统的权限设置,如果文件权限错误,用户依然可能无法获得网页数据.



## 常见攻击手段

下面介绍一些常见的攻击手法及防范措施:

- 暴力破解密码

  假如别人知道了你的主机地址,可以利用端口扫描工具(如NMAP)来扫描主机,得出主机上面运行的服务,例如邮箱服务.接下来使用脚本来尝试惯用管理员账号如admin的密码,通过密码字典就能破解一些简单密码,取得管理权限.

  不过现在很多软件都有密码输入次数限制,连续输入错误到一定次数,会限制攻击者访问.此时攻击者可以用代理池来更换IP地址继续破解,不过耗时耗力,所以现在比较少见了.

  对于此类攻击,设置一个不易破解的密码最重要.其次可以设定密码修改策略,提高密码破解难度.

- 利用程序漏洞主动攻击

  程序Bug可能造成安全问题,导致系统权限被攻击者掌握.由于程序问题被公开后,网上会出现针对漏洞的攻击程序代码,很容易被别有用心的人拿来使用,因此这类攻击比较常见.

  针对解决方法也很简单:保持系统更新,关闭掉不需要的软件和服务即可.

- 利用社会工程学欺骗

  社会工程学欺骗方式很多,有些甚至完全不需要懂电脑技术,例如通过邮件和仿制网站钓鱼,来骗取用户账号密码.

  只要记住不要随便透露账号密码信息,多留意下网站网址或交流对象身份即可.

- 利用程序功能的被动攻击

  在一些利用浏览器漏洞的网站上,只是打开页面就能运行网站上插入的恶意代码,进而使主机遭受攻击.

  作为应对,记得更新浏览器和设置好不要自动下载运行文件.

- 蠕虫和木马的Rootkit

  蠕虫会让主机一直发送数据包向外攻击.木马则是在主机中开启一个后面(端口),来进一步控制主机.

  Rootkit是指可以取得root权限的一群工具组,主要也是通过主机的程序漏洞进行攻击.很多Rootkit本身就是蠕虫或木马,主要通过下载安装带有Rootkit的软件来传播,一旦被绑架非常不好追踪与去除.

  作为防范最重要的一点是别下载安装来路不明的程序,另外可以安装防范扫描Rootkit的软件,确保万无一失.

- DDoS攻击

  DDoS(Distributed Denial of Service)叫分布式拒绝攻击,通过分散在世界各地的僵尸计算机进行高频率的请求,从而让正常请求无法处理.

  最常见的是SYN Flood攻击法,发送带有SYN的TCP数据包请求连接,但将服务器的回复确认数据包丢弃,造成服务器一直处于等待状态.一旦此类数据包过多,服务器的端口被占用完毕,便不能继续提供服务了.

  现在的云服务商和CDN服务商都有一定的抵御DDoS攻击能力,会自动阻断不正常的请求和流量,因此可以按需要购买.

总之完善好防火墙规则,自动更新软件与定时检查日志,是应对网络攻击最基础的工作.



## 防火墙

防火墙就是通过定义一些有序规则,并管理进入到网络内的主机数据包的一种机制.只要能够分析与过滤进出管理的网络数据包的数据,就可以称为防火墙.防火墙最大的功能就是限制某些服务的访问来源.

网络数据包一般有四个基本信息,就是来源与目标的IP与端口.防火墙即对数据包报头进行分析,根据设定的规则来对数据包进行放行或丢弃.防火墙在OSI七层协议中具体作用如下:

- 第二层: 可以针对来源与目标的MAC进行阻挡.
- 第三层: 主要针对来源与目标的IP,以及ICMP的类别进行阻挡.
- 第四层: 针对TCP/UDP的端口进行阻挡,也可以针对TCP的状态来处理.

防火墙又分为硬件和软件防火墙.硬件防火墙是由厂商设计好的主机硬件,硬件操作系统主要以提供数据包数据的过滤机制为主,并将其他不必要的功能拿掉.而软件防火墙本身就是保护系统网络安全的一套软件.



## iptables
