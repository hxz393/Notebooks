# 修改权限

## 修改文件所属用户组

使用chgrp可以改变一个文件的所属用户组,目标组名必须已经存在/etc/group.

例如修改dir1文件夹的所属组为tss:

 ```shell
 [root@101c7 ~]# chgrp tss dir1 ; ll
 total 4
 -rw-------. 1 root root 1260 Sep  7 13:38 anaconda-ks.cfg
 drwxr-xr-x. 2 ftp  tss    16 Sep  8 23:29 dir1
 ```

使用选项-R可以递归修改目录dir1下内容的所属组:

```shell
[root@101c7 ~]# chgrp input -R dir1 ; ll dir1
total 0
-rw-r--r--. 1 root input 0 Sep  8 23:29 xx
```



## 修改文件所有者

使用chown命令可以同时修改文件所有者和所属组,目标用户名必须已经存在/etc/passwd.

例如修改文件夹dir1的所有者为lp,所属组tape:

```shell
[root@101c7 ~]# chown lp:tape dir1 ; ll
total 4
-rw-------. 1 root root 1260 Sep  7 13:38 anaconda-ks.cfg
drwxr-xr-x. 2 lp   tape   16 Sep  8 23:29 dir1
```

同样可以使用-R参数来递归修改目录所有者:

```shell
[root@101c7 ~]# chown -R ftp:ftp dir1 ; ll dir1
total 0
-rw-r--r--. 1 ftp ftp 0 Sep  8 23:29 xx
```



## 修改文件权限

使用chmod设置权限(只有文件所有者和root能执行)可以使用数字或字符来更改,数字类型采用数字累加来代表:

| 数字 | 字符 | 权限(文件/目录)                                             |
| ---- | ---- | ----------------------------------------------------------- |
| 4    | r    | 读取文件内容/查看目录下的文件或目录名称(无法看到属性)       |
| 2    | w    | 修改文件内容(不包含删除)/在目录下新建,删除,重命名文件或目录 |
| 1    | x    | 文件可以被系统执行/进入目录,遍历目录                        |

特殊权限:

| 数字 | 权限(文件/目录)  |
| ---- | ---------------- |
| 4    | SUID(用在文件上) |
| 2    | SGID             |
| 1    | SBIT(用在目录上) |

例如修改dir1文件夹的权限为rwxrw---x:

```sh
[root@101c7 ~]# chmod 761 dir1 ; ll
total 4
-rw-------. 1 root root 1260 Sep  7 13:38 anaconda-ks.cfg
drwxrw---x. 2 ftp  tss    16 Sep  8 23:29 dir1
```

用字符类型改变文件权限方式:

- 用u,g,o,a分别表示所有者,组,其他人,所有人.
- 用+,-,=分别增加,去除,设置权限,没有指定的权限不会变动.

例如设置dir1文件夹及其下的所有文件权限为rwxrwxr--:

```shell
[root@101c7 ~]# chmod -R u=rwx,g=rwx,o=r dir1
[root@101c7 ~]# ll dir1
total 0
-rwxrwxr--. 1 ftp root 0 Sep  8 23:29 xx
```

设置dir文件夹禁止进入:

```sh
[root@101c7 ~]# chmod a-x dir1 ; ll
total 4
-rw-------. 1 root root 1260 Sep  7 13:38 anaconda-ks.cfg
drw-rw-r--. 2 ftp  tss    16 Sep  8 23:29 dir1
```

给文件2设置SUID/SGID的权限(也可以通过u+s,g+s,o+t来设置SUID,SGID,SBIT):

```sh
[root@101c7 ~]# chmod 6755 2; ls -l 2
-rwsr-sr-x. 1 root root 0 Sep  9 07:57 2
```

当用户没有执行权限却设置了特殊权限时,表示特殊权限的s和t会变成S和T,表示无效权限.例如:

```sh
[root@101c7 ~]# chmod 7666 2; ll 2
-rwSrwSrwT. 1 root root 0 Sep  9 08:57 2
```



## 修改默认权限

文件创建时默认(umask为000的情况)权限是666,文件夹是777,可以使用umask来对这一权限进一步削弱.

root用户的umask默认是022,一般用户是002.

查看目前用户在新建文件和目录时的权限默认值:

  ```sh
  [root@101c7 audit]# umask
  0022
  ```

上面表示为新建文件拿掉所属组和其他用户的w权限.如果要给属组加入w权限,定义umask值:

```sh
[root@101c7 audit]# umask 002 ; umask
0002
```



