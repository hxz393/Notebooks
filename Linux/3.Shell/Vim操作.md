# Vim操作

## 文件浏览

光标移动针对的是在一般模式下快速浏览/定位文件.

**光标移动**

可以使用方向键← ↓ ↑ →或h j k l操作光标左/右/下/上移一个字符.

可使用数字组合,例如30k代表光标向上移30行.

**翻页**

使用快捷键Ctrl+f/Catrl+b来控制屏幕向下/上移动一页,相当于PageDown/PageUp.

**移动指定行**

输入nG(n为数字)将光标移动到第n行位置.



## 文件编辑

一般模式下进行文件内容编辑.

**删除**

使用x/X来删除当前光标后/前个字符.

可以使用数字组合,例如9x代表删除光标后连续9个字符.

**剪切**

使用dd剪切光标所在行.

可以使用数字组合,例如9dd代表向下删除9行.

**复制**

使用yy复制光标所在行.

可以使用数字组合,例如9yy代表复制向下9行.

**粘贴**

使用p/P来将剪贴板数据粘贴到光标下/上一行.

**撤销**

使用u来撤销上一次操作.

**重做**

使用Ctrl+r快捷键来反撤销操作.



## 进入编辑模式

主要有两个常用模式:

**按i:** 

进入到插入模式(Insert Mode)

**按r/R:** 

进入到替换/连续替换模式(Replace Mode)



## **搜索替换**

搜索替换功能在命令模式下完成.

### 搜索

/word: 向下搜索字符串word.

?word: 向上搜索字符串word.

对搜索结果按键n/N进行向下/向上跳转

### 替换

**替换表达式**:

:{作用范围}s/{搜索关键词}/{替换成关键词}/{替换标志}

**作用范围**:

n1,n2: n1和n2为数字,表示在n1和n2行之间搜寻关键词并替换.例如在100到200行之间搜索:100,200s/XS/xs/g

1,&s: 表示从第1行到最后一行

**替换标志**:

g: 表示全部替换,否则只会替换找到的第一个结果

i/I: 表示搜索不区分/区分大小写,默认是区分大小写

c: 表示替换前提示确认



## 读取保存文件

包括退出vim,在命令行模式下完成.

**保存**:

:w 直接保存文件.

:w! 强制保存文件,针对某些设为只读权限的文件可以强制写入.

:w file2 另存为当前编辑的文件为file2

**退出**:

:q 直接退出.

:q! 强制退出,针对修改了文件内容不想保存情况下退出.

:wq! 强制保存并退出.

ZZ 保存后退出,等同于wq

**读取**:

:r file1 读取文件file1,并将内容加到光标所在行后面



## 设置和其他命令

在命令行模式下可以使用的功能.

使用:set all查看所有配置.使用:set查看有更改过的参数.

**行号:**

:set nu 设置行号,默认设置nonu没有行号.

**自动缩进:**

:set autoindent 设置自动缩进,默认设置noautoindent没有自动缩进.

**设置备份:**

:set backup 设置自动保存备份文件,默认设置nobackup没有备份.

**语法高亮:**

:syntax on 依据语法来显示不同颜色.默认设置syntax off

**跳转:**

:n 直接跳转到第n行

**显示文件名:**

:f 显示正在编辑的文件名等信息

**执行命令:**

:! command 暂时离开vi到命令行模式下执行命令并展示结果



## 块选择模式

在一般模式下,按Ctrl+v进入块选择模式,之后用方向键操作光标选择块:

```sh
[root@101c7 audit]# vi c.log 
c1  ass
c2  bss
c3  css
~
-- VISUAL BLOCK --  
```

此模式下按y复制,按d删除.



## 同时编辑

可以同时用vim打开多个文件:

```sh
[root@101c7 4]# vi 1.txt 2.txt
2 files to edit

~
~
"1.txt" 0L, 0C                                                                           0,0-1         All
```

输入命令:n或:N来编辑下一个或上一个文件.

输入命令:files列出目前打开的所有文件.



## 多窗口功能

在命令模式下输入:sp可对当前文件切割成上下两个窗口显示:

```sh
111
11
1
~
~
1.txt                                                                                    3,1            All
111
11
1
~
1.txt                                                                                    1,1            All
:sp
```

通过按键Ctrl+w来切换窗口.

也可以用sp指定文件名,这样上下窗口分别显示两个不同文件内容.

